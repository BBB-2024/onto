<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
</body>
<script>
    //feladat4
    
    /*function index() { 
        let xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = () => {
            if (xhttp.readyState == 4 && xhttp.status == 200) {
                let response = JSON.parse(xhttp.response);
                console.log(response);
                let responseData = {
                    original_data:response.data,
                    id:response.data.ID,
                    teamcode:"be98b0b567b9887e75e5",
                    original_hash:response.hash,
                    answer_data:[]
                };
                response.data.questions.forEach((question)=>{
                    let road = {};
                    question.params.map.roads.forEach(element => {
                        if (question.params.road_id = element.id) {
                            road = element;
                            return;
                        }
                    });
                    let answer = [];

                    question.params.map.roads.forEach((selectedRoad)=>{
                        selectedRoad.tiles.forEach((selectedRoadTile)=>{
                            road.tiles.forEach(tile => {
                                if(tile.x == selectedRoadTile.x && tile.y == selectedRoadTile.y) {
                                    answer.push(selectedRoad.id);
                                    return;
                                }
                            });
                        });
                    });``
                    responseData.answer_data.push({
                        'id':question.ID,
                        'answer':answer
                    });
                });
                console.log(responseData);
                let xhr = new XMLHttpRequest();
                xhr.onreadystatechange = ( ) => {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        console.log(xhr.response);
                    }
                }
                xhr.open('POST','http://bitkozpont.mik.uni-pannon.hu/2024/answer.php',true)
                xhr.send(JSON.stringify(responseData));
            }
        }
        xhttp.open('POST','http://bitkozpont.mik.uni-pannon.hu/2024/gettasks.php',true);
        xhttp.send(JSON.stringify(
            {
                id:'5',
                teamcode:'be98b0b567b9887e75e5'
            }
        ));
    }
    index();*/

    function index() { 
        let xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = () => {
            if (xhttp.readyState == 4 && xhttp.status == 200) {
                let response = JSON.parse(xhttp.response);
                console.log(response);
                let responseData = {
                    original_data:response.data,
                    id:response.data.ID,
                    teamcode:"be98b0b567b9887e75e5",
                    original_hash:response.hash,
                    answer_data:[]
                };
                let answer = "";
                let mostDistance = 0;
                response.data.questions.forEach((question)=>{
                    question.params.map.cities.forEach((city)=>{
                        for (const key in city.distances) {
                            if (mostDistance < city.distances[key]) {
                                answer = key;
                            }
                        }
                    });
                    responseData.answer_data.push(
                        {
                            id:question.ID,
                            answer:answer
                        }
                    );
                    answer = "";
                    mostDistance = 0;
                });
                console.log(responseData);
                let xhr = new XMLHttpRequest();
                xhr.onreadystatechange = ( ) => {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        console.log(xhr.response);
                    }
                }
                xhr.open('POST','http://bitkozpont.mik.uni-pannon.hu/2024/answer.php',true)
                xhr.send(JSON.stringify(responseData));
            }
        }
        xhttp.open('POST','http://bitkozpont.mik.uni-pannon.hu/2024/gettasks.php',true);
        xhttp.send(JSON.stringify(
            {
                id:'5',
                teamcode:'be98b0b567b9887e75e5'
            }
        ));
    }
    index();
</script>
</html>